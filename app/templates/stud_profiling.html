{% extends "base.html" %}
{% block title %}Student Profile{% endblock %}

{% block content %}
<div class="p-6 space-y-8">

  <!-- Page Title -->
  <h2 class="text-3xl font-bold text-white tracking-wide mb-6">🎓 Student Profile</h2>

  <!-- Top Section -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

    <!-- Avatar Card -->
    <div class="bg-gray-900 border border-gray-700 rounded-xl shadow-lg p-6 flex flex-col items-center justify-center">
      <div class="w-36 h-36 bg-gray-700 rounded-full flex items-center justify-center mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-20 h-20 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 
            1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 
            4v2h16v-2c0-2.66-5.33-4-8-4z" />
        </svg>
      </div>
      <h2 class="text-2xl font-bold text-white">{{ student.name }}</h2>
      <p class="text-green-400 font-medium">{{ student.course }}</p>
    </div>

    <!-- Info Card -->
    <div class="lg:col-span-2 bg-gray-900 border border-gray-700 rounded-xl shadow-lg p-6">
      <h3 class="text-xl font-semibold text-white mb-4">Student Information</h3>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 text-gray-300">
        <div>
          <p class="font-semibold text-gray-400">Name:</p>
          <p>{{ student.name }}</p>
        </div>
        <div>
          <p class="font-semibold text-gray-400">USN:</p>
          <p>{{ student.usn }}</p>
        </div>
        <div>
          <p class="font-semibold text-gray-400">Course:</p>
          <p>{{ student.course }}</p>
        </div>
        <div>
          <p class="font-semibold text-gray-400">Gmail:</p>
          <p>{{ student.gmail }}</p>
        </div>
        <div class="sm:col-span-2 lg:col-span-3">
          <p class="font-semibold text-gray-400">Address:</p>
          <p>{{ student.address }}</p>
        </div>
      </div>
    </div>

  </div>

  <!-- Stats & History -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

    <!-- Attendance Stats -->
    <div class="bg-gray-900 border border-gray-700 rounded-xl shadow-lg p-6">
      <h3 class="text-xl font-semibold text-white mb-4">📊 Attendance Overview</h3>
      <div class="grid grid-cols-3 gap-4">
        <div class="bg-gray-800 rounded-xl p-4 text-center shadow">
          <h4 class="text-lg font-medium text-green-400">Attended</h4>
          <p class="text-3xl font-bold text-white mt-2">{{ attended }}</p>
        </div>
        <div class="bg-gray-800 rounded-xl p-4 text-center shadow">
          <h4 class="text-lg font-medium text-red-400">Missed</h4>
          <p class="text-3xl font-bold text-white mt-2">{{ missed }}</p>
        </div>
        <div class="bg-gray-800 rounded-xl p-4 text-center shadow">
          <h4 class="text-lg font-medium text-yellow-400">Late</h4>
          <p class="text-3xl font-bold text-white mt-2">{{ late }}</p>
        </div>
      </div>
    </div>

    <!-- Event History -->
    <div class="lg:col-span-2 bg-gray-900 border border-gray-700 rounded-xl shadow-lg p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-2xl font-semibold text-gray-100">📅 Event History</h3>
        <input id="searchInput" type="text" placeholder="Search events..." class="bg-gray-800 text-white px-3 py-2 rounded-lg border border-gray-600 focus:outline-none focus:ring focus:ring-blue-500">
      </div>

      <!-- Table -->
      <div class="overflow-x-auto">
        <table class="w-full border-collapse">
          <thead>
            <tr class="bg-gray-800 text-gray-300 text-left text-sm uppercase tracking-wider">
              <th class="px-4 py-3">Event</th>
              <th class="px-4 py-3">Date</th>
              <th class="px-4 py-3">Status</th>
            </tr>
          </thead>
          <tbody id="eventTableBody">
            {% for event in events %}
            <tr class="border-b border-gray-700 hover:bg-gray-800 transition">
              <td class="px-4 py-3 text-white">{{ event.event_name }}</td>
              <td class="px-4 py-3 text-gray-300">{{ event.event_date }}</td>
              <td class="px-4 py-3">
                <span class="px-2 py-1 
                  {% if event.status=='Attended' %}
                    bg-green-600
                  {% elif event.status=='Missed' %}
                    bg-red-600
                  {% elif event.status=='Late' %}
                    bg-yellow-600
                  {% endif %}
                  text-white text-xs rounded">
                  {{ event.status }}
                </span>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

    </div>
  </div>

</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const searchInput = document.getElementById("searchInput");
  searchInput.addEventListener("input", function() {
    const filter = this.value.toLowerCase();
    const rows = document.querySelectorAll("#eventTableBody tr");
    rows.forEach(row => {
      const text = row.textContent.toLowerCase();
      row.style.display = text.includes(filter) ? "" : "none";
    });
  });
});
</script>

{% endblock %}
